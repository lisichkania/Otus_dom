# Секционирование
## Загрузка файла demo-big-en.zip и Создание базы demo
*Загрузка базы с данными*
```
otus@otus-db-pg-vm-1:~$ wget https://edu.postgrespro.com/demo-big-en.zip
--2024-04-07 15:27:13--  https://edu.postgrespro.com/demo-big-en.zip
Resolving edu.postgrespro.com (edu.postgrespro.com)... 213.171.56.196
Connecting to edu.postgrespro.com (edu.postgrespro.com)|213.171.56.196|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 243203220 (232M) [application/zip]
Saving to: ‘demo-big-en.zip’

demo-big-en.zip               100%[=================================================>] 231.94M   109MB/s    in 2.1s

2024-04-07 15:27:15 (109 MB/s) - ‘demo-big-en.zip’ saved [243203220/243203220]

otus@otus-db-pg-vm-1:~$  ls -l
total 779040
-rw-rw-r-- 1 otus otus 244985782 Oct 30  2016 ads.pgdump
-rw-rw-r-- 1 otus otus 244985782 Oct 30  2016 ads.pgdump.1
-rw-rw-r-- 1 otus otus 243203220 Feb 21  2018 demo-big-en.zip
-rw-rw-r-- 1 otus otus  64544920 Feb 21  2018 demo-medium-en.zip
drwxrwxr-x 3 otus otus      4096 Mar 12 23:58 sysbench-tpcc
```

*Хотела распаковать архив, но пришлось установить еще unzip*
```
otus@otus-db-pg-vm-1:~$ unzip demo-big-en.zip
Command 'unzip' not found, but can be installed with:
apt install unzip
Please ask your administrator.
otus@otus-db-pg-vm-1:~$ apt install unzip
E: Could not open lock file /var/lib/dpkg/lock-frontend - open (13: Permission denied)
E: Unable to acquire the dpkg frontend lock (/var/lib/dpkg/lock-frontend), are you root?
otus@otus-db-pg-vm-1:~$ sudo apt install unzip
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
Suggested packages:
  zip
The following NEW packages will be installed:
  unzip
0 upgraded, 1 newly installed, 0 to remove and 15 not upgraded.
Need to get 175 kB of archives.
After this operation, 386 kB of additional disk space will be used.
Get:1 http://mirror.yandex.ru/ubuntu jammy-updates/main amd64 unzip amd64 6.0-26ubuntu3.2 [175 kB]
Fetched 175 kB in 0s (10.5 MB/s)
Selecting previously unselected package unzip.
(Reading database ... 112466 files and directories currently installed.)
Preparing to unpack .../unzip_6.0-26ubuntu3.2_amd64.deb ...
Unpacking unzip (6.0-26ubuntu3.2) ...
Setting up unzip (6.0-26ubuntu3.2) ...
Processing triggers for man-db (2.10.2-1) ...
Scanning processes...
Scanning linux images...

Running kernel seems to be up-to-date.

No services need to be restarted.

No containers need to be restarted.

No user sessions are running outdated binaries.

No VM guests are running outdated hypervisor (qemu) binaries on this host.
otus@otus-db-pg-vm-1:~$ unzip demo-big-en.zip
Archive:  demo-big-en.zip
  inflating: demo-big-en-20170815.sql
otus@otus-db-pg-vm-1:~$ ls -l
total 1688292
-rw-rw-r-- 1 otus otus 244985782 Oct 30  2016 ads.pgdump
-rw-rw-r-- 1 otus otus 244985782 Oct 30  2016 ads.pgdump.1
-rwxrwxrwx 1 otus otus 931068524 Feb 21  2018 demo-big-en-20170815.sql
-rw-rw-r-- 1 otus otus 243203220 Feb 21  2018 demo-big-en.zip
-rw-rw-r-- 1 otus otus  64544920 Feb 21  2018 demo-medium-en.zip
drwxrwxr-x 3 otus otus      4096 Mar 12 23:58 sysbench-tpcc
```

*Устанавливаем базу данных*
```
otus@otus-db-pg-vm-1:~$ psql -f demo-big-en-20170815.sql -U postgres
SET
SET
SET
SET
SET
SET
SET
SET
psql:demo-big-en-20170815.sql:17: ERROR:  database "demo" does not exist
CREATE DATABASE
You are now connected to database "demo" as user "postgres".
...
```

## Проверка наличия таблиц из базы demo и выбор таблицы с которой будем работать
```
postgres=# \l
                                                 List of databases
   Name    |  Owner   | Encoding |   Collate   |    Ctype    | ICU Locale | Locale Provider |   Access privileges
-----------+----------+----------+-------------+-------------+------------+-----------------+-----------------------
 demo      | postgres | UTF8     | en_US.UTF-8 | en_US.UTF-8 |            | libc            |
 postgres  | postgres | UTF8     | en_US.UTF-8 | en_US.UTF-8 |            | libc            |
 template0 | postgres | UTF8     | en_US.UTF-8 | en_US.UTF-8 |            | libc            | =c/postgres          +
           |          |          |             |             |            |                 | postgres=CTc/postgres
 template1 | postgres | UTF8     | en_US.UTF-8 | en_US.UTF-8 |            | libc            | =c/postgres          +
           |          |          |             |             |            |                 | postgres=CTc/postgres
(4 rows)

postgres=# \c demo
You are now connected to database "demo" as user "postgres".
demo=# \dn
       List of schemas
   Name   |       Owner
----------+-------------------
 bookings | postgres
 public   | pg_database_owner
(2 rows)

demo=# \dt
               List of relations
  Schema  |      Name       | Type  |  Owner
----------+-----------------+-------+----------
 bookings | aircrafts_data  | table | postgres
 bookings | airports_data   | table | postgres
 bookings | boarding_passes | table | postgres
 bookings | bookings        | table | postgres
 bookings | flights         | table | postgres
 bookings | seats           | table | postgres
 bookings | ticket_flights  | table | postgres
 bookings | tickets         | table | postgres
(8 rows)

demo=# SELECT count(*) FROM bookings.ticket_flights;
  count
---------
 8391852
(1 row)
```

## Выбор метода и запуск секционирования таблиц
```

```
